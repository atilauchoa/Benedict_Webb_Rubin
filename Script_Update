import math
from tabulate import tabulate
import matplotlib.pyplot as plt

def print_parameter_table():
    """
    Print a table with BWR parameters for various gases.
    """
    # TÃ­tulo da tabela em negrito
    print("\033[1mTable with BWR parameters for various gases\033[0m")

    # Definindo os dados da tabela
    data = [
        ["Metano (CHâ‚„)", 2.2572, 0.6461, 0.00819, 3.62, 0.09907, 0.0838, 0.1371, 0.00535, 0.0437],
        ["Etileno (Câ‚‚Hâ‚„)", 4.3767, 0.7857, 0.01403, 5.309, 0.0850, 0.101, 0.1947, 0.00654, 0.0272],
        ["Propano (Câ‚ƒHâ‚ˆ)", 4.7556, 1.1730, 0.02183, 6.56, 0.1120, 0.144, 0.2478, 0.00736, 0.0265],
        ["AmÃ´nia (NHâ‚ƒ)", 1.9531, 0.7372, 0.00547, 2.71, 0.0652, 0.0525, 0.1084, 0.00354, 0.0673],
        ["DiÃ³xido de Carbono (COâ‚‚)", 3.5928, 0.6707, 0.01294, 4.42, 0.0830, 0.097, 0.1788, 0.00567, 0.0455],
        ["HidrogÃªnio (Hâ‚‚)", 1.1292, 0.0393, 0.00068, 1.71, 0.0347, 0.0354, 0.0307, 0.00024, 0.0899],
        ["Cloro (Clâ‚‚)", 6.6791, 1.7110, 0.04868, 8.34, 0.0740, 0.165, 0.2446, 0.01356, 0.0285],
        ["DiÃ³xido de Enxofre (SOâ‚‚)", 5.0630, 0.7296, 0.03175, 6.63, 0.0850, 0.0690, 0.0987, 0.00232, 0.0757],
        ["Nitreto de Carbono (Nâ‚‚)", 2.0790, 0.4280, 0.00428, 3.51, 0.0655, 0.0215, 0.0380, 0.00098, 0.0392],
        ["Acetileno (Câ‚‚Hâ‚‚)", 3.2721, 0.6347, 0.01374, 4.37, 0.0841, 0.0883, 0.1400, 0.00435, 0.0182]
    ]

    # CabeÃ§alhos da tabela
    headers = ["GÃ¡s", "A0 (atmÂ·LÂ²/molÂ²)", "B0 (L/mol)", "C0 (LÂ³/molÂ²)", "a (atmÂ·LÂ²/molÂ²)", "b (L/mol)", "Î± (atmÂ·Lâ¶/molâ¶)", "c (atmÂ·LÂ³/molÂ³)", "Î³ (LÂ²/molÂ²)", "Densidade Molar (mol/L)"]

    # Imprimindo a tabela
    print(tabulate(data, headers=headers, tablefmt="grid", floatfmt=".4f"))

def bwr_pressure(rho, T, R, B0, A0, C0, b, a, alpha, c, gamma):
    """
    Calculate pressure using the Benedict-Webb-Rubin (BWR) equation.
    
    Parameters:
    rho (float): Molar density (mol/L)
    T (float): Temperature (K)
    R (float): Universal gas constant (LÂ·atm/(KÂ·mol))
    B0 (float): BWR constant B0
    A0 (float): BWR constant A0
    C0 (float): BWR constant C0
    b (float): BWR constant b
    a (float): BWR constant a
    alpha (float): BWR constant alpha
    c (float): BWR constant c
    gamma (float): BWR constant gamma
    
    Returns:
    float: Pressure in atmospheres (atm)
    """
    term1 = rho * R * T
    term2 = (B0 * R * T - A0 - C0 / T**2) * rho**2
    term3 = (b * R * T - a) * rho**3
    term4 = alpha * a * rho**6
    term5 = (c * rho**3 / T**2) * (1 + gamma * rho**2) * math.exp(gamma * rho**2)
    
    pressure = term1 + term2 + term3 + term4 + term5
    return pressure

def main():
    # Perguntar ao usuÃ¡rio se deseja consultar a tabela de valores
    consult_table = input("Deseja consultar a tabela de valores empÃ­ricos para gases? (S/N): ").strip().upper()
    
    if consult_table == 'S':
        # Imprimir a tabela de parÃ¢metros
        print_parameter_table()
    
    print("\nEscolha a variÃ¡vel de interesse para calcular usando a equaÃ§Ã£o de BWR:")
    print("1 - Calcular pressÃ£o (p)")
    print("2 - Densidade molar (ğœŒ)")
    print("3 - Coeficiente atraÃ§Ã£o intermolecular (A0)")
    print("4 - Coeficiente de segunda ordem (B0)")
    print("5 - Coeficiente de interaÃ§Ãµes de longo alcance (C0)")
    print("6 - Coeficiente (a)")
    print("7 - Coeficiente (b)")
    print("8 - Fator ajustÃ¡vel (Î±)")
    print("9 - Coeficiente que modulaÃ§Ã£o (c)")
    print("10 - Coeficiente exponencial (Î³)")
    
    option = int(input("Digite a opÃ§Ã£o: "))
    
    if option == 1:
        rho = float(input("Digite a densidade molar (Ï) em mol/L: "))
        T = float(input("Digite o valor da temperatura (T) em Kelvin: "))
        R = 0.0821  # Constante universal dos gases em LÂ·atm/(KÂ·mol)
        A0 = float(input("Digite o valor de A0: "))
        B0 = float(input("Digite o valor de B0: "))
        C0 = float(input("Digite o valor de C0: "))
        b = float(input("Digite o valor de b: "))
        a = float(input("Digite o valor de a: "))
        alpha = float(input("Digite o valor de Î±: "))
        c = float(input("Digite o valor de c: "))
        gamma = float(input("Digite o valor de Î³: "))
        
        # Calcula a pressÃ£o para a primeira temperatura
        P = bwr_pressure(rho, T, R, B0, A0, C0, b, a, alpha, c, gamma)
        print(f"\nO valor de P em atm para T = {T:.2f} K Ã©: {P:.4f}")
        
        # Pergunta se o usuÃ¡rio deseja calcular para outras temperaturas
        more_temps = input("Deseja calcular o valor de p para outras temperaturas? (S/N): ").strip().upper()
        if more_temps == 'S':
            num_temps = int(input("Quantas temperaturas deseja calcular? "))
            temps = []
            pressures = []
            for _ in range(num_temps):
                temp = float(input(f"Digite a temperatura {_+1} em Kelvin: "))
                temps.append(temp)
                # Calcula a pressÃ£o para cada temperatura fornecida
                P = bwr_pressure(rho, temp, R, B0, A0, C0, b, a, alpha, c, gamma)
                pressures.append(P)
            
            # Exibir os resultados em formato de tabela
            print("\nResultados para as temperaturas fornecidas:")
            results = list(zip(temps, pressures))
            headers = ["Temperatura (K)", "PressÃ£o (atm)"]
            print(tabulate(results, headers=headers, tablefmt="grid", floatfmt=".4f"))
            
            # Plotar o grÃ¡fico
            plt.figure(figsize=(10, 6))
            plt.plot(temps, pressures, marker='o', linestyle='-', color='b')
            plt.title('RelaÃ§Ã£o entre PressÃ£o e Temperatura')
            plt.xlabel('Temperatura (K)')
            plt.ylabel('PressÃ£o (atm)')
            plt.grid(True)
            plt.show()
        
    else:
        print("OpÃ§Ã£o invÃ¡lida.")

if __name__ == "__main__":
    main()
